## 1. 文件概述

**文件名**: `stations.json`  
**用途**: 存储RIA|ZTH服务器中所有车站的基础信息，包括位置、所属线路和换乘关系  
**维护者**: AutMoonWhite
**更新日期**: 2025-12-11
**版本**: 1.0.0

## 2. 数据结构总览

本JSON文件为**数组结构**，包含多个车站对象：

```jsonc
[
  {
    "stationName": "普通车站",   //车站名称
    "lines": [
      {
        "bureau": "R",          //路局代码
        "line": "1",            //线路编号
        "stationCode": 1,       //车站编号
        "coord": { "x": 100.0, "y": 64.0, "z": 100.0 }
        //车站坐标，依次为x坐标、y坐标、z坐标
      }
    ]
  },

  {
    "stationName": "换乘车站",
    "lines": [
      //多条线经过同一个站，将所有站台数据分别存入lines列表
      {
        "bureau": "R",
        "line": "1",
        "stationCode": 2,
        "coord": { "x": 200.0, "y": 64.0, "z": 100.0 }
      },
      {
        "bureau": "R",
        "line": "2",
        "stationCode": 7,
        "coord": { "x": 200.0, "y": 64.0, "z": 64.0 }
      },
      {
        "bureau": "R",
        "line": "3",
        "stationCode": 2,
        "coord": { "x": 200.0, "y": 64.0, "z": 132.0 }
      }
    ],

    "specialCases": [ //特殊情况
      {
        "type": "directionNotAvaliable",  //方向未开通
        "target": {                   //无法前往R3-1
          "bureau": "R",
          "line": "3",
          "stationCode": 1
        }
      },
      {
        "type": "lineNotAvaliable",       //线路未开通
        "target": {                   //R2线未开通，不能乘坐
          "bureau": "R",
          "line": "2"
        }
      },
      {
        "type": "skipStation",            //跳过车站
        "target": {                   //R1线不停R1-3，下一个停靠的站为R1-4
          "bureau": "R",
          "line": "1",
          "stationCode": 4            //4为下一个停靠车站的编号
        }
      }
    ]
  }
]
```
以上数据（仅包括左起第一个“普通车站”与“换乘车站”）对应的参考配线图：
![](./车站数据示例配线图.png)
## 3 字段详细说明

### 3.1 车站对象 (Station Object)
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `stationName` | string | ✓ | 车站唯一名称 | "普通车站" |
| `lines` | array | ✓ | 该站经行线路列表 | 见3.2 |
| `specialCases` | array | × | 特殊情况列表 | 见3.4 |

### 3.2 线路信息对象 (Line Info Object)
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `bureau` | string | ✓ | 路局/运营公司代码 | "R" |
| `line` | string | ✓ | 线路编号 | "1", "A", "2b" |
| `stationCode` | integer | ✓ | 该线路上的车站序号 | 1, 2, 10 |
| `coord` | object | ✓ | 车站坐标 | 见3.3 |

### 3.3 坐标对象 (Coordinate Object)
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `x` | float | ✓ | X坐标 | 100.0 |
| `y` | float | ✓ | Y坐标 | 64.0 |
| `z` | float | ✓ | Z坐标 | 200.0 |

### 3.4 特殊情况对象 (Special Case Object)
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `type` | string | ✓ | 特殊情况类型 | directionNotAvaliable |
| `target` | object | ✓ | 特殊情况目标 | 见下 |

特殊情况分三种：
| 值 | 释义 | 说明
|--------|------|-|
| directionNotAvaliable | 方向未开通 | 某条线路的某个方向未开通 |
| lineNotAvaliable | 线路未开通 | 某条线路在这个车站未开通 |
| skipStation | 跳过车站 | 前方车站越行，下一站的编号并非本站编号±1 |

在这些情况下，对象target中的字段与含义不同：

**directionNotAvaliable**（方向未开通）
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `bureau` | string | ✓ | 路局/运营公司代码 | "R" |
| `line` | string | ✓ | 线路编号 | "3" |
| `stationCode` | integer | ✓ | 未开通方向的下一站编号 | 1 |

对象指向的车站不能在本站乘车到达。

该情况适用于两种情况：
* 单向行驶的支线铁路，即示例中给出的R3线；
* 本站和下一站都在运营，但是连接两个站之间的线路未通车。
※当且仅当涉及的车站编号相邻时使用。
举例：如果R1-4和R1-5都在运营，但是两个站之间没有通车，则需要使用本特殊情况；但是如果R1-5未开通，R1-6已开通，那在R1-5的数据没有存入stations.json的情况下，不需要添加此特殊情况。

**lineNotAvaliable**（线路未开通）
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `bureau` | string | ✓ | 路局/运营公司代码 | "R" |
| `line` | string | ✓ | 线路编号 | "2" |

对象指向的线路在本站尚未开通。
原则上未开通的线路不应录入本数据库；在已开通线路因故暂停运营时，可以用此特殊情况进行标记。

**skipStation**（跳过车站）
| 字段名 | 类型 | 必需 | 说明 | 示例 |
|--------|------|------|------|------|
| `bureau` | string | ✓ | 路局/运营公司代码 | "R" |
| `line` | string | ✓ | 线路编号 | "1" |
| `stationCode` | integer | ✓ | 停靠的下一站 | 4 |

对象指向的车站为该方向的下一个**停靠站点**。

## 99 处理特殊情况时可能碰到的坑
判断上下行（根据target的站点编号和当前站编号确定需要特殊处理的是上行还是下行）